<?xml version="1.0" encoding="UTF-8" ?>
<XMLDB PATH="local/bioauth/db" VERSION="20130611" COMMENT="XMLDB file for Moodle local/bioauth"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="../../../lib/xmldb/xmldb.xsd"
>
  <TABLES>
    <TABLE NAME="bioauth_sessions" COMMENT="Behavioral biometric logging sessions.">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="userid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Foreign key reference to the user this session belongs to."/>
        <FIELD NAME="starttime" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="The time this session was started."/>
        <FIELD NAME="endtime" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="The time the session ended."/>
        <FIELD NAME="tag" TYPE="char" LENGTH="100" NOTNULL="false" SEQUENCE="false" COMMENT="Tag for the session."/>
        <FIELD NAME="locale" TYPE="char" LENGTH="10" NOTNULL="false" SEQUENCE="false" COMMENT="The locale for this session."/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="userid" TYPE="foreign" FIELDS="userid" REFTABLE="user" REFFIELDS="id"/>
      </KEYS>
    </TABLE>
    <TABLE NAME="bioauth_subtasks" COMMENT="Subtasks performed during a session.">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="userid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Foreign key reference to the user this subtask belongs to"/>
        <FIELD NAME="sessionid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Foreign key reference to the session this subtask belongs to"/>
        <FIELD NAME="tag" TYPE="char" LENGTH="100" NOTNULL="false" SEQUENCE="false" COMMENT="Tag for this subtask."/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="userid" TYPE="foreign" FIELDS="userid" REFTABLE="user" REFFIELDS="id"/>
        <KEY NAME="sessionid" TYPE="foreign" FIELDS="sessionid" REFTABLE="bioauth_sessions" REFFIELDS="id"/>
      </KEYS>
    </TABLE>
    <TABLE NAME="bioauth_keys" COMMENT="Keys which may be pressed and released in keystroke events.">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="keystring" TYPE="char" LENGTH="20" NOTNULL="true" SEQUENCE="false" COMMENT="A string representation for this key"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
      </KEYS>
    </TABLE>
    <TABLE NAME="bioauth_keystroke_features" COMMENT="Temporal keystroke feature sets for behavioral biometric sequences.">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="featureset" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="The feature set to which this feature belongs."/>
        <FIELD NAME="action1" TYPE="int" LENGTH="1" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Action of the first key: 0 for press, 1 for release."/>
        <FIELD NAME="fallbacknode1" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="The first fallback node to use as observations."/>
        <FIELD NAME="action2" TYPE="int" LENGTH="1" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Action for the second key: 0 for press, 1 for release."/>
        <FIELD NAME="fallbacknode2" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="The second fallback node to use as observations."/>
        <FIELD NAME="measure" TYPE="char" LENGTH="30" NOTNULL="true" SEQUENCE="false" COMMENT="The measure function to use on the observations gathered for this feature."/>
        <FIELD NAME="distance" TYPE="int" LENGTH="4" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="The distance between the two keystrokes in the sequence."/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="fallbacknode1" TYPE="foreign" FIELDS="fallbacknode1" REFTABLE="bioauth_fallback" REFFIELDS="node"/>
        <KEY NAME="fallbacknode2" TYPE="foreign" FIELDS="fallbacknode2" REFTABLE="bioauth_fallback" REFFIELDS="node"/>
      </KEYS>
    </TABLE>
    <TABLE NAME="bioauth_keystroke_fallback" COMMENT="The fallback hierarchy for features">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="node" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="The node within the model to which this fallback belongs."/>
        <FIELD NAME="parentid" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false" COMMENT="The parent node of this fallback. Null for no parent."/>
        <FIELD NAME="keyid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Foreign reference to the key for this fallback node."/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="node" TYPE="primary" FIELDS="node"/>
        <KEY NAME="parentid" TYPE="foreign" FIELDS="parentid" REFTABLE="bioauth_fallback" REFFIELDS="node"/>
        <KEY NAME="keyid" TYPE="foreign" FIELDS="keyid" REFTABLE="bioauth_keys" REFFIELDS="id"/>
      </KEYS>
    </TABLE>
    <TABLE NAME="bioauth_keystroke_events" COMMENT="Raw keystroke data collected during logging sessions.">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="userid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Foreign key reference to the user this event belongs to."/>
        <FIELD NAME="sessionid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Foreign key reference to the session this event was recorded during."/>
        <FIELD NAME="subtaskid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Foreign key reference to the subtask this event was recorded during."/>
        <FIELD NAME="keyid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Foreign key reference to the key that was pressed and released."/>
        <FIELD NAME="presstime" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Timestamp of when this key was pressed."/>
        <FIELD NAME="releasetime" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Timestamp of when this key was released."/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="userid" TYPE="foreign" FIELDS="userid" REFTABLE="user" REFFIELDS="id"/>
        <KEY NAME="sessionid" TYPE="foreign" FIELDS="sessionid" REFTABLE="bioauth_sessions" REFFIELDS="id"/>
        <KEY NAME="subtaskid" TYPE="foreign" FIELDS="subtaskid" REFTABLE="bioauth_subtasks" REFFIELDS="id"/>
        <KEY NAME="keyid" TYPE="foreign" FIELDS="keyid" REFTABLE="bioauth_keys" REFFIELDS="id"/>
      </KEYS>
    </TABLE>
    <TABLE NAME="bioauth_stylometry_events" COMMENT="Stylometry events collected during logging sessions.">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="userid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Foreign key reference to the user this event belongs to."/>
        <FIELD NAME="sessionid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Foreign key reference to the session the even was recorded during."/>
        <FIELD NAME="subtaskid" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Foreign key reference to the subtask this event belongs to."/>
        <FIELD NAME="starttime" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="The time this event started."/>
        <FIELD NAME="endtime" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="The time this event ended."/>
        <FIELD NAME="text" TYPE="text" NOTNULL="true" SEQUENCE="false" COMMENT="The text entered during the stylometry event"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="userid" TYPE="foreign" FIELDS="userid" REFTABLE="user" REFFIELDS="id"/>
        <KEY NAME="sessionid" TYPE="foreign" FIELDS="sessionid" REFTABLE="bioauth_sessions" REFFIELDS="id"/>
        <KEY NAME="subtaskid" TYPE="foreign" FIELDS="subtaskid" REFTABLE="bioauth_subtasks" REFFIELDS="id"/>
      </KEYS>
    </TABLE>
  </TABLES>
</XMLDB>